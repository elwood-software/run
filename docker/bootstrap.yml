# yaml-language-server: $schema=../schema/bootstrap.json

cleanup: before
workflow:
  name: "bootstrap"
  defaults:
    permissions: true
  jobs:
    default:
      steps:
        - action: install/whisper
        - action: fs/copy
          input:
            src: "/tmp/fixtures/Gettysburg_by_Britton.ogg"
            dest: "stage://sample.ogg"
        - action: run
          input:
            bin: whisper
            args:
              - --verbose
              - "True"
              - --language
              - en
              - --output_dir
              - $ELWOOD_STAGE
              - $ELWOOD_STAGE/sample.ogg
        - name: read
          action: fs/read
          input:
            src: "stage:///sample.srt"
            output: "srt"
        - action: ai/openai
          input:
            model: "text-davinci-003"
            prompt:
              - ${{ join(["Identify advertisement segments in the following text:", steps.read.outputs.srt], "\n") }}
